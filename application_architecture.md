## Архитектура веб-приложения для дизайна интерьера

Приложение будет иметь модульную архитектуру, состоящую из трех основных компонентов: Фронтенд (клиентская часть), Бэкенд (серверная часть) и База данных.

### 1. Фронтенд (Клиентская часть)

*   **Технологии:** React, Three.js, (возможно, react-three-fiber для упрощения интеграции Three.js и React).
*   **Основные модули:**
    *   **Пользовательский интерфейс (UI):** Разработан с использованием React. Включает в себя основные элементы управления, навигацию, панели инструментов, диалоговые окна.
    *   **Редактор планов (2D/3D):**
        *   **2D Редактор:** Позволит пользователям рисовать стены, двери, окна на двухмерном плане. Будет использовать HTML5 Canvas или SVG, управляемый React.
        *   **3D Визуализатор:** Реализован с помощью Three.js. Будет отображать 2D-план в трехмерном виде. Обеспечит возможность навигации по сцене (ходьба с помощью стрелок клавиатуры).
        *   **Переключение видов:** Механизм для плавного переключения между 2D-редактором и 3D-визуализатором.
    *   **Библиотека мебели:**
        *   **Отображение моделей:** Просмотр списка доступных 3D-моделей мебели (загруженных с сервера).
        *   **Размещение мебели:** Функционал drag-and-drop для размещения выбранной мебели на 3D-сцене.
        *   **Загрузка пользовательских моделей:** Интерфейс для загрузки пользователем собственных 3D-моделей (например, в форматах .obj, .gltf). Файлы будут отправляться на бэкенд для обработки и сохранения.
    *   **Менеджер проектов:**
        *   Создание, сохранение, загрузка и удаление проектов дизайна.
    *   **Модуль экспорта в Blender:**
        *   Формирование данных о сцене (геометрия помещения, расположение и тип мебели) в формате, совместимом с Blender (например, через Python-скрипт, который будет генерироваться на бэкенде, или через промежуточный формат типа .gltf, который Blender хорошо импортирует).
        *   Предоставление пользователю возможности скачать файл проекта для Blender.
*   **Взаимодействие с Бэкендом:** Через REST API (HTTP запросы - GET, POST, PUT, DELETE) для получения данных (например, списки мебели, проекты пользователя), сохранения изменений, загрузки моделей и т.д.

### 2. Бэкенд (Серверная часть)

*   **Технологии:** Python, Flask, SQLAlchemy (для работы с базой данных).
*   **Основные модули (API Endpoints):**
    *   **Аутентификация и Авторизация (опционально, если потребуется управление пользователями):**
        *   Регистрация, вход, управление сессиями.
    *   **Управление проектами:**
        *   CRUD операции для проектов пользователей (создание, чтение, обновление, удаление).
        *   Сохранение данных о плане помещения (координаты стен, расположение окон, дверей).
        *   Сохранение информации о расставленной мебели (ID модели, позиция, ротация).
    *   **Управление 3D-моделями мебели:**
        *   API для получения списка стандартных моделей мебели.
        *   API для загрузки пользовательских 3D-моделей: прием файла, валидация, возможно, конвертация в стандартный формат, сохранение файла и метаданных в базе.
    *   **Экспорт в Blender:**
        *   API для генерации файла, совместимого с Blender. Это может быть:
            *   Генерация Python-скрипта (.py), который при запуске в Blender воссоздаст сцену.
            *   Конвертация сцены в формат .gltf или .fbx, который Blender может импортировать.
        *   Предоставление файла для скачивания клиенту.
*   **Логика:** Обработка бизнес-логики, валидация данных, взаимодействие с базой данных.

### 3. База данных

*   **Технология:** PostgreSQL.
*   **Основные таблицы (примерная структура):**
    *   `Users` (если реализована аутентификация): `user_id`, `username`, `password_hash`, `email`, и т.д.
    *   `Projects`: `project_id`, `user_id` (foreign key), `project_name`, `creation_date`, `last_modified_date`, `room_data` (JSON или XML с описанием геометрии помещения), `camera_position_3d`.
    *   `FurnitureModels`: `model_id`, `model_name`, `description`, `model_file_path` (путь к файлу 3D-модели на сервере), `thumbnail_path`, `category`, `is_default` (флаг, стандартная ли это модель).
    *   `PlacedFurniture`: `placed_id`, `project_id` (foreign key), `model_id` (foreign key), `position_x`, `position_y`, `position_z`, `rotation_x`, `rotation_y`, `rotation_z`, `scale_x`, `scale_y`, `scale_z`.

### Схема взаимодействия

1.  **Пользователь** взаимодействует с **Фронтендом** через браузер.
2.  **Фронтенд** отображает интерфейс, обрабатывает действия пользователя (рисование плана, выбор мебели) и отправляет запросы на **Бэкенд** через REST API.
3.  **Бэкенд** обрабатывает запросы, выполняет бизнес-логику и взаимодействует с **Базой данных PostgreSQL** для чтения или записи данных.
4.  **Бэкенд** возвращает ответ (данные или статус операции) **Фронтенду**.
5.  **Фронтенд** обновляет UI на основе полученного ответа.
6.  Для экспорта в Blender: **Фронтенд** запрашивает у **Бэкенда** файл проекта. **Бэкенд** генерирует файл (например, .py скрипт или .gltf) на основе данных из **Базы данных** и передает его **Фронтенду** для скачивания пользователем.

### Ключевые аспекты

*   **Масштабируемость:** Модульная архитектура позволяет независимо разрабатывать и масштабировать фронтенд и бэкенд.
*   **Поддержка 3D:** Использование Three.js на фронтенде и хранение 3D-моделей на бэкенде обеспечивают необходимую функциональность.
*   **Экспорт в Blender:** Четко определенный API на бэкенде для генерации совместимого файла.
*   **Хранение данных:** PostgreSQL обеспечивает надежное хранение структурированных данных о проектах и моделях.

Эта архитектура обеспечивает четкое разделение задач и позволяет реализовать все требуемые функции.
